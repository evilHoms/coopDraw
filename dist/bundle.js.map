{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 74099ce264045f4fae92","webpack:///./src/request/request.js","webpack:///./src/app.js","webpack:///./src/room/room.js","webpack:///./src/popup/popup.js","webpack:///./src/canvas/canvas.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_classCallCheck","instance","Constructor","TypeError","value","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","Requests","this","url","Promise","resolve","reject","fetch","then","res","json","host","pass","arguments","undefined","form","FormData","append","base","rooms","document","querySelectorAll","isUnick","randomEnding","Math","round","random","forEach","el","dataset","roomId","method","body","guest","console","log","image","fetchOpts","status","catch","imageId","data","buildRooms","wrapper","textContent","room","roomEl","_room","Room","users","onConnectClick","appendChild","e","preventDefault","currentTarget","classList","contains","popup","_popup","Popup","onPopupSubmitClick","root","querySelector","focus","onNewRoomBtnClick","newRoomPopup","type","_request","newRoom","requestUrl","add","editor","_canvas","Canvas","er","connectRoom","background","parentElement","removeChild","newRoomBtn","roomsList","getRooms","addEventListener","hostName","guestsCount","eventHandler","updateRoom","_this","createElement","guests","connect","eventHendler","createPopup","main","title","nameWrapper","nameLabel","setAttribute","nameInput","id","passWrapper","passLabel","passInput","submitButton","editorElement","userName","isHost","ableToDraw","loader","buffer","lastBufferItem","pathBuffer","isQueue","clearCanvas","ctx","drawImage","drawBuffered","ws","send","canvasBuffer","Image","canvas","getContext","drawOpts","isFirstPoint","isLastPoint","tool","current","coords","x1","y1","x2","y2","xCur","yCur","options","lineJoin","lineCap","lineWidth","strokeStyle","fillStyle","backgroundColor","connection","setListeners","JSON","parse","event","src","pic","mask","remove","window","close","deleteRoom","canvasToImage","init","_this2","self","cleared","splice","toBlob","blob","URL","createObjectURL","buildUsersPanel","buildAsideMenu","initCanvas","onControllBtnClick","btn","disconnectRoom","buildUser","user","controlls","togglePermission","removeGuest","permissions","permissionTitle","permissionStatus","style","opacity","_this3","panel","usersWrapper","userPanelControlls","closeBtn","clearBtn","addAsideElement","element","onToolClick","addSettingElement","settingElement","onSettingClick","widthInput","aside","showOptionMenu","_this4","tools","settings","toolsWrapper","settingsWrapper","option","onBtnClick","onOptionInput","setOption","optionInput","currentOptionBtn","getElementById","usersMenu","colors","colorsWrapper","color","cansel","getBoundingClientRect","y","parseFloat","getComputedStyle","height","offsetHeight","onMouseDown","onMouseMove","canvasBoundingRect","pageX","x","pageY","draw","onMouseUp","removeEventListener","_this5","width","innerWidth","innerHeight","left","newImage","setImageId","WebSocket","clearRect","drawPoint","drawLine","drawRect","drawEllipse","erase","pos","moveTo","lineTo","stroke","isPath","beginPath","rect","fill","closePath","ellipse","dx","dy","PI","strokeWidth","push","actions","abs","save","globalCompositeOperation","restore"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Requests = exports.Requests = function () {\n  function Requests() {\n    _classCallCheck(this, Requests);\n  }\n\n  _createClass(Requests, null, [{\n    key: 'getRooms',\n    value: function getRooms(url) {\n      return new Promise(function (resolve, reject) {\n        fetch(url).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          resolve(res);\n        });\n      });\n    }\n  }, {\n    key: 'newRoom',\n    value: function newRoom(url, host) {\n      var pass = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      //Request to adding new room\n      return new Promise(function (resolve, reject) {\n        var form = new FormData();\n        form.append('host', host);\n        form.append('password', pass);\n        form.append('roomId', generateRandomRoomId('room'));\n\n        fetch(url, {\n          method: 'POST',\n          body: form\n        }).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          resolve(res);\n        });\n\n        function generateRandomRoomId(base) {\n          var rooms = document.querySelectorAll('.room');\n          var isUnick = void 0;\n          var randomEnding = void 0;\n\n          do {\n            isUnick = true;\n            randomEnding = Math.round(Math.random() * 10000);\n            rooms.forEach(function (el) {\n              if (el.dataset.roomId === base + randomEnding) isUnick = false;\n            });\n          } while (!isUnick);\n\n          return base + randomEnding;\n        }\n      });\n    }\n  }, {\n    key: 'connectRoom',\n    value: function connectRoom(url, guest, roomId) {\n      var pass = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n      //Request to connect the room\n      return new Promise(function (resolve, reject) {\n        var form = new FormData();\n        form.append('name', guest);\n        form.append('password', pass);\n        form.append('action', 'connect');\n        form.append('roomId', roomId);\n        console.log(url);\n        fetch(url, {\n          method: 'PUT',\n          body: form\n        }).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          resolve(res);\n        });\n      });\n    }\n  }, {\n    key: 'disconnectRoom',\n    value: function disconnectRoom(url, guest, roomId) {\n      //Request to disconnect the room\n      return new Promise(function (resolve, reject) {\n        var form = new FormData();\n        form.append('name', guest);\n        form.append('action', 'disconnect');\n        form.append('roomId', roomId);\n        console.log(url);\n        fetch(url, {\n          method: 'PUT',\n          body: form\n        }).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          resolve(res);\n        });\n      });\n    }\n  }, {\n    key: 'deleteRoom',\n    value: function deleteRoom(url, roomId) {\n      //Request to delete the room\n      return new Promise(function (resolve, reject) {\n        var form = new FormData();\n        form.append('roomId', roomId);\n        console.log(url);\n        fetch(url, {\n          method: 'DELETE',\n          body: form\n        }).then(function (res) {\n          return res.json();\n        }).then(function (res) {\n          resolve(res);\n        });\n      });\n    }\n  }, {\n    key: 'newImage',\n    value: function newImage(url, image, name) {\n      // Посылаем POST запрос на сервер http://neto-api.herokuapp.com/pic\n      // Content-Type: multipart/form-data\n      // Тело запроса - формдата, с полями title, image(название, изображение)\n      // В ответе приходит id изображения, записать в imageId конкретной комнаты\n      // Можно делать данный запрос и передавать в канву в app.js\n      return new Promise(function (resolve, reject) {\n        var form = new FormData();\n        form.append('title', name);\n        form.append('image', image);\n        var fetchOpts = {\n          method: 'POST',\n          body: form\n        };\n        fetch(url, fetchOpts).then(function (res) {\n          if (res.status === 200) return res.json();else reject(res);\n        }).then(function (res) {\n          console.log(res);\n          resolve(res);\n        }).catch(reject);\n      });\n    }\n  }, {\n    key: 'setImageId',\n    value: function setImageId(url, roomId, imageId) {\n      return new Promise(function (resolve, reject) {\n        var data = new FormData();\n        data.append('roomId', roomId);\n        data.append('imageId', imageId);\n        // const data = JSON.stringify({\n        //   roomId: roomId,\n        //   imageId: imageId\n        // });\n        var fetchOpts = {\n          method: 'PATCH',\n          body: data\n        };\n        fetch(url, fetchOpts).then(function (res) {\n          return res.json();\n        }).then(resolve).catch(reject);\n      });\n    }\n  }]);\n\n  return Requests;\n}();\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(2);\n\nvar _room = __webpack_require__(3);\n\nvar _request = __webpack_require__(0);\n\nvar _popup = __webpack_require__(5);\n\nvar _canvas = __webpack_require__(7);\n\n// Адрес один, тк различаются типом запроса GET POST DELETE\nvar requestUrl = 'http://localhost:3000/rooms';\n\nvar root = document.querySelector('#root');\nvar newRoomBtn = document.querySelector('.new-room--btn');\nvar roomsList = document.querySelector('.rooms__list');\nvar editor = null;\n\n_request.Requests.getRooms(requestUrl).then(function (res) {\n  if (res.length) {\n    console.log(res);\n    buildRooms(roomsList, res);\n  } else {\n    document.querySelector('.rooms__title').textContent = 'No Rooms';\n  }\n}).catch(function (er) {\n  return console.log(er);\n});\n\nnewRoomBtn.addEventListener('click', onNewRoomBtnClick);\n\nfunction buildRooms(wrapper, rooms) {\n  wrapper.textContent = '';\n  rooms.forEach(function (room) {\n    var roomEl = new _room.Room(room.host, room.roomId, room.users.length - 1, onConnectClick);\n    wrapper.appendChild(roomEl.room);\n  });\n}\n\nfunction onConnectClick(e) {\n  e.preventDefault();\n  var roomId = e.currentTarget.dataset.roomId;\n  if (!e.target.classList.contains('room__connect--btn')) return;\n\n  var popup = new _popup.Popup('connectRoom', onPopupSubmitClick, roomId);\n  root.appendChild(popup.popup);\n  document.querySelector('.popup').querySelector('input').focus();\n}\n\nfunction onNewRoomBtnClick(e) {\n  e.preventDefault();\n  var newRoomPopup = new _popup.Popup('newRoom', onPopupSubmitClick);\n  root.appendChild(newRoomPopup.popup);\n  document.querySelector('.popup').querySelector('input').focus();\n}\n\nfunction onPopupSubmitClick(e) {\n  e && e.preventDefault();\n  if (!e.target.classList.contains('popup__submit--btn')) return;\n\n  var name = this.querySelector('#nameInput').value;\n  var pass = this.querySelector('#passInput').value;\n  console.log(name, pass);\n\n  if (this.dataset.type === 'newRoom') {\n    _request.Requests.newRoom(requestUrl, name, pass)\n    //Создается объект canvas\n    .then(function (res) {\n      document.querySelector('.rooms').classList.add('hidden');\n      document.querySelector('.controlls').classList.add('hidden');\n      editor = new _canvas.Canvas(document.querySelector('.editor'), res.host, res.users, name, true, res.roomId);\n    }).catch(function (er) {\n      return console.log(er);\n    });\n  } else if (this.dataset.type === 'connectRoom') {\n    var roomId = e.currentTarget.dataset.roomId;\n    console.log(roomId);\n    _request.Requests.connectRoom(requestUrl, name, roomId, pass)\n    //Создается объект canvas\n    .then(function (res) {\n      document.querySelector('.rooms').classList.add('hidden');\n      document.querySelector('.controlls').classList.add('hidden');\n      editor = new _canvas.Canvas(document.querySelector('.editor'), res.host, res.users, name, false, roomId, res.imageId, res.background);\n    }).catch(function (er) {\n      return console.log(er);\n    });\n  }\n\n  this.parentElement.removeChild(this);\n}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Room = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n__webpack_require__(4);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Room = exports.Room = function () {\n  function Room(hostName, roomId, guestsCount, eventHandler) {\n    _classCallCheck(this, Room);\n\n    this.hostName = hostName;\n    this.guestsCount = guestsCount;\n    this.roomId = roomId;\n    this.room = null;\n    this.updateRoom(this.guestsCount);\n    this.room.addEventListener('click', eventHandler);\n  }\n\n  _createClass(Room, [{\n    key: 'updateRoom',\n    value: function updateRoom(guestsCount) {\n      var _this = this;\n\n      this.guestsCount = guestsCount;\n\n      this.room = function () {\n        var room = document.createElement('div');\n        room.classList.add('room');\n        room.dataset.roomId = _this.roomId;\n\n        var host = document.createElement('div');\n        host.classList.add('room__host');\n        host.textContent = 'Host: ' + _this.hostName;\n\n        var guests = document.createElement('div');\n        guests.classList.add('room__guests');\n        guests.textContent = 'Guests: ' + _this.guestsCount;\n\n        var connect = document.createElement('button');\n        connect.classList.add('room__connect--btn');\n        connect.textContent = 'Connect';\n\n        room.appendChild(host);\n        room.appendChild(guests);\n        room.appendChild(connect);\n\n        return room;\n      }();\n    }\n  }]);\n\n  return Room;\n}();\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Popup = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n__webpack_require__(6);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Popup = exports.Popup = function () {\n  function Popup(type, eventHendler, roomId) {\n    _classCallCheck(this, Popup);\n\n    this.type = type;\n    this.popup = null;\n    this.roomId = roomId;\n    this.createPopup();\n    this.popup.addEventListener('click', eventHendler);\n  }\n\n  _createClass(Popup, [{\n    key: 'createPopup',\n    value: function createPopup() {\n      var _this = this;\n\n      this.popup = function () {\n        var popup = document.createElement('div');\n        popup.classList.add('popup');\n        popup.dataset.type = _this.type;\n        popup.dataset.roomId = _this.roomId;\n\n        var main = document.createElement('div');\n        main.classList.add('popup__main');\n\n        var title = document.createElement('h3');\n        title.classList.add('popup__title');\n        if (_this.type === 'newRoom') {\n          title.textContent = 'Creating New Room';\n        } else if (_this.type === 'connectRoom') {\n          title.textContent = 'Connecting The Room';\n        }\n\n        var nameWrapper = document.createElement('div');\n        nameWrapper.classList.add('input-wrapper');\n        var nameLabel = document.createElement('label');\n        nameLabel.classList.add('popup__label');\n        nameLabel.setAttribute('for', 'nameInput');\n        nameLabel.textContent = 'Name: ';\n        var nameInput = document.createElement('input');\n        nameInput.classList.add('popup__input');\n        nameInput.id = 'nameInput';\n        nameWrapper.appendChild(nameLabel);\n        nameWrapper.appendChild(nameInput);\n\n        var passWrapper = document.createElement('div');\n        passWrapper.classList.add('input-wrapper');\n        var passLabel = document.createElement('label');\n        passLabel.classList.add('popup__label');\n        passLabel.setAttribute('for', 'passInput');\n        passLabel.textContent = 'Password: ';\n        var passInput = document.createElement('input');\n        passInput.classList.add('popup__input');\n        passInput.id = 'passInput';\n        passWrapper.appendChild(passLabel);\n        passWrapper.appendChild(passInput);\n\n        var submitButton = document.createElement('button');\n        submitButton.classList.add('popup__submit--btn');\n        submitButton.textContent = 'submit';\n\n        main.appendChild(title);\n        main.appendChild(nameWrapper);\n        main.appendChild(passWrapper);\n        main.appendChild(submitButton);\n        popup.appendChild(main);\n\n        return popup;\n      }();\n    }\n  }]);\n\n  return Popup;\n}();\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Canvas = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _request = __webpack_require__(0);\n\n__webpack_require__(8);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar requestUrl = 'http://localhost:3000/rooms';\nvar imageUrl = 'https://neto-api.herokuapp.com/pic';\nvar wsUrl = 'wss://neto-api.herokuapp.com/pic';\n\nvar Canvas = exports.Canvas = function () {\n  function Canvas(editorElement, host, users, userName, isHost, roomId) {\n    var _this = this;\n\n    var imageId = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n    var background = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : '#fff';\n\n    _classCallCheck(this, Canvas);\n\n    this.editor = editorElement;\n    this.host = host;\n    this.users = users;\n    this.userName = userName;\n    this.isHost = isHost;\n    this.ableToDraw = true;\n    this.roomId = roomId;\n    this.imageId = imageId;\n    this.loader = document.querySelector('.canvas-loader');\n    this.buffer = [];\n    this.lastBufferItem = null;\n    this.pathBuffer = [];\n    this.isQueue = false;\n    this.image = this.editor.querySelector('.editor__image');\n    this.image.addEventListener('load', function (e) {\n      _this.clearCanvas();\n      console.log('loaded new image');\n      _this.ctx.drawImage(_this.image, 0, 0);\n      _this.drawBuffered();\n      if (_this.buffer.length > 1) _this.ws.send();else {\n        _this.isQueue = false;\n      }\n    });\n    this.canvasBuffer = new Image();\n    this.canvas = this.editor.querySelector('#canvas');\n    this.ctx = canvas.getContext('2d');\n    this.drawOpts = {\n      isFirstPoint: true,\n      isLastPoint: false\n    };\n    this.tool = {\n      current: 'pen'\n    };\n    this.coords = {\n      x1: null,\n      y1: null,\n      x2: null,\n      y2: null,\n      xCur: null,\n      yCur: null\n    };\n    this.options = {\n      lineJoin: 'round',\n      lineCap: 'round',\n      lineWidth: 10,\n      strokeStyle: '#000',\n      fillStyle: '#999',\n      backgroundColor: background\n    };\n    this.ws = {\n      url: null,\n      connection: null,\n      setListeners: function setListeners() {\n        _this.ws.connection.addEventListener('open', function (e) {\n          return console.log('connection opened');\n        });\n        _this.ws.connection.addEventListener('message', function (e) {\n          console.log('new ws message: ' + e.data);\n          var data = JSON.parse(e.data);\n          switch (data.event) {\n            case 'pic':\n              _this.image.src = data.pic.mask ? data.pic.mask : data.pic.url;\n              _this.editor.classList.remove('hidden');\n              _this.loader.classList.add('hidden');\n              break;\n            case 'mask':\n              _this.image.src = data.url;\n              break;\n          }\n        });\n        _this.ws.connection.addEventListener('close', function (e) {\n          return console.log('connection closed');\n        });\n        _this.ws.connection.addEventListener('error', function (e) {\n          return console.log('some ws error: ' + e.data);\n        });\n        window.addEventListener('beforeunload', function (e) {\n          _this.ws.connection.close();\n          if (_this.isHost) {\n            console.log(_this);\n            _request.Requests.deleteRoom(requestUrl, _this.roomId);\n          }\n        });\n      },\n      send: function send() {\n        _this.canvasToImage().then(function (res) {\n          _this.ws.connection.send(res);\n        }).catch(console.log);\n      }\n    };\n\n    this.init();\n    this.editor.querySelector('#pen').classList.add('selected');\n  }\n\n  _createClass(Canvas, [{\n    key: 'canvasToImage',\n    value: function canvasToImage() {\n      var _this2 = this;\n\n      var self = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n      var cleared = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      return new Promise(function (resolve) {\n        _this2.clearCanvas();\n        if (!cleared) {\n          _this2.ctx.drawImage(_this2.canvasBuffer, 0, 0);\n          _this2.drawBuffered();\n        }\n        _this2.buffer.splice(0, _this2.buffer.length - 1);\n        self.canvas.toBlob(function (blob) {\n          self.canvasBuffer.src = URL.createObjectURL(blob);\n          resolve(blob);\n        });\n      });\n    }\n  }, {\n    key: 'init',\n    value: function init() {\n      this.loader.classList.remove('hidden');\n      this.buildUsersPanel();\n      this.buildAsideMenu();\n      this.initCanvas();\n    }\n  }, {\n    key: 'buildUsersPanel',\n    value: function buildUsersPanel() {\n      var _this3 = this;\n\n      var panel = this.editor.querySelector('.users');\n      panel.textContent = '';\n      var usersWrapper = document.createElement('div');\n\n      this.users.forEach(function (el) {\n        usersWrapper.appendChild(buildUser(el, _this3));\n      });\n\n      var userPanelControlls = document.createElement('div');\n      userPanelControlls.classList.add('users__control-btns--wrapper');\n      var closeBtn = document.createElement('button');\n      closeBtn.classList.add('users__control-btn');\n      closeBtn.textContent = 'exit';\n      closeBtn.dataset.btn = 'close';\n      var clearBtn = document.createElement('button');\n      clearBtn.classList.add('users__control-btn');\n      clearBtn.textContent = 'clear';\n      clearBtn.dataset.btn = 'clear';\n\n      this.isHost && userPanelControlls.appendChild(clearBtn);\n      userPanelControlls.appendChild(closeBtn);\n\n      panel.appendChild(usersWrapper);\n      panel.appendChild(userPanelControlls);\n\n      userPanelControlls.addEventListener('click', function (e, self) {\n        return onControllBtnClick(e, _this3);\n      });\n\n      function onControllBtnClick(e, self) {\n        switch (e.target.dataset.btn) {\n          case 'close':\n            console.log('close');\n            document.querySelector('.rooms').classList.remove('hidden');\n            document.querySelector('.controlls').classList.remove('hidden');\n            document.querySelector('.editor').classList.add('hidden');\n            console.log('roomId: ' + self.roomId);\n            this.ws.connection.close();\n            if (!self.isHost) {\n              _request.Requests.disconnectRoom(requestUrl, self.userName, self.roomId);\n            } else {\n              _request.Requests.deleteRoom(requestUrl, self.roomId);\n            }\n            self = null;\n            break;\n          case 'clear':\n            if (self.isHost) {\n              console.log('clear');\n              self.canvasToImage(self, true).then(function (res) {\n                return self.ws.connection.send(res);\n              }).catch(console.log);\n            }\n            break;\n        }\n      }\n\n      function buildUser(user, self) {\n        var wrapper = document.createElement('div');\n        wrapper.classList.add('user');\n\n        var title = document.createElement('h3');\n        title.classList.add('user__title');\n        title.textContent = user.isHost ? 'Host: ' : 'Guest: ';\n\n        var userName = document.createElement('div');\n        userName.classList.add('user__name');\n        userName.textContent = user.name;\n\n        var controlls = document.createElement('div');\n        controlls.classList.add('user__controls');\n        var togglePermission = document.createElement('button');\n        togglePermission.classList.add('user__btn');\n        togglePermission.textContent = 'D';\n        var removeGuest = document.createElement('button');\n        removeGuest.classList.add('user__btn');\n        removeGuest.textContent = 'X';\n        controlls.appendChild(togglePermission);\n        controlls.appendChild(removeGuest);\n\n        var permissions = document.createElement('div');\n        permissions.classList.add('user__permissions');\n        var permissionTitle = document.createElement('div');\n        permissionTitle.classList.add('user__permission-title');\n        permissionTitle.textContent = 'Drawing';\n        var permissionStatus = document.createElement('div');\n        permissionStatus.classList.add('user__permission-status');\n        permissions.appendChild(permissionTitle);\n        permissions.appendChild(permissionStatus);\n\n        wrapper.appendChild(title);\n        wrapper.appendChild(userName);\n        wrapper.appendChild(self.isHost ? controlls : permissions);\n        if (user.isHost) {\n          controlls.style.opacity = 0;\n          permissions.style.opacity = 0;\n        }\n\n        return wrapper;\n      }\n    }\n  }, {\n    key: 'buildAsideMenu',\n    value: function buildAsideMenu() {\n      var _this4 = this;\n\n      var aside = this.editor.querySelector('.editor__menu');\n      var tools = ['pen', 'line', 'rectangle', 'ellipse', '', '', 'erase'];\n\n      var settings = ['lineWidth', 'fillStyle', 'strokeStyle', 'backgroundColor'];\n\n      var toolsWrapper = document.createElement('div');\n      toolsWrapper.classList.add('users__tools-wrapper');\n      var settingsWrapper = document.createElement('div');\n      settingsWrapper.classList.add('users__settings-wrapper');\n\n      aside.textContent = '';\n      tools.forEach(function (el) {\n        addAsideElement(toolsWrapper, el, _this4);\n      });\n      settings.forEach(function (el) {\n        addSettingElement(settingsWrapper, el, _this4);\n      });\n\n      aside.appendChild(toolsWrapper);\n      aside.appendChild(settingsWrapper);\n\n      function addAsideElement(wrapper, tool, self) {\n        var element = document.createElement('div');\n        if (tool === '') {\n          element.classList.add('hidden-tool');\n        } else {\n          element.classList.add('tool');\n          element.id = tool;\n          element.textContent = tool;\n          element.addEventListener('click', function (e) {\n            onToolClick(e, self);\n          });\n        }\n        wrapper.appendChild(element);\n      }\n\n      function addSettingElement(wrapper, element, self) {\n        var settingElement = document.createElement('div');\n\n        settingElement.classList.add('setting');\n        settingElement.id = element;\n        settingElement.addEventListener('click', function (e) {\n          onSettingClick(e, self);\n        });\n        var title = document.createElement('div');\n        var name = document.createElement('div');\n        name.classList.add('setting__name');\n        var value = document.createElement('div');\n        value.classList.add('setting__value');\n        name.textContent = element + ': ';\n        switch (element) {\n          case 'lineWidth':\n            var widthInput = document.createElement('input');\n            widthInput.classList.add('setting__input');\n            widthInput.value = self.options.lineWidth;\n            widthInput.addEventListener('input', function (e) {\n              self.options.lineWidth = e.currentTarget.value;\n            });\n            value.appendChild(widthInput);\n            break;\n          case 'strokeStyle':\n            value.textContent = self.options.strokeStyle;\n            break;\n          case 'fillStyle':\n            value.textContent = self.options.fillStyle;\n            break;\n          case 'backgroundColor':\n            value.textContent = self.options.backgroundColor;\n            break;\n          default:\n        }\n        title.appendChild(name);\n        title.appendChild(value);\n        settingElement.appendChild(title);\n        wrapper.appendChild(settingElement);\n      }\n\n      function onToolClick(e, self) {\n        self.editor.querySelector('.selected').classList.remove('selected');\n        self.tool.current = e.currentTarget.id;\n        e.currentTarget.classList.add('selected');\n      }\n\n      function onSettingClick(e, self) {\n        switch (e.currentTarget.id) {\n          case 'lineWidth':\n            var lineWidthInput = aside.querySelector('#lineWidth').querySelector('.setting__input');\n            lineWidthInput.focus();\n            break;\n          case 'strokeStyle':\n          case 'fillStyle':\n          case 'backgroundColor':\n            if (self.editor.querySelector('.option-menu')) aside.removeChild(self.editor.querySelector('.option-menu'));\n            aside.appendChild(self.showOptionMenu(e.currentTarget.id));\n            break;\n          default:\n            if (self.editor.querySelector('.option-menu')) aside.removeChild(self.editor.querySelector('.option-menu'));\n        }\n      }\n    }\n  }, {\n    key: 'showOptionMenu',\n    value: function showOptionMenu(option) {\n      var self = this;\n      var currentOptionBtn = document.getElementById(option);\n      var usersMenu = document.querySelector('.users');\n\n      var colors = ['white', 'black', 'red', 'orange', 'yellow', 'green', 'blue', 'purple'];\n      var wrapper = document.createElement('div');\n      wrapper.classList.add('option-menu');\n      var title = document.createElement('h3');\n      var colorsWrapper = document.createElement('div');\n      colorsWrapper.classList.add('option-menu__colors');\n      setColors(this);\n      var optionInput = document.createElement('input');\n      optionInput.classList.add('option-menu__input');\n      optionInput.value = this.options[option];\n      var cansel = document.createElement('button');\n      cansel.textContent = 'Cansel';\n      cansel.dataset.btn = 'cansel';\n\n      switch (option) {\n        case 'strokeStyle':\n          title.textContent = 'Stroke Color:';\n          wrapper.dataset.type = 'strokeStyle';\n          break;\n        case 'fillStyle':\n          title.textContent = 'Fill Color:';\n          wrapper.dataset.type = 'fillStyle';\n          break;\n        case 'backgroundColor':\n          title.textContent = 'Background Color:';\n          wrapper.dataset.type = 'backgroundColor';\n          break;\n      }\n\n      wrapper.addEventListener('click', function (e) {\n        return onBtnClick(e, self);\n      });\n      wrapper.addEventListener('input', function (e) {\n        return onOptionInput(e, self);\n      });\n\n      wrapper.appendChild(title);\n      wrapper.appendChild(colorsWrapper);\n      wrapper.appendChild(optionInput);\n      wrapper.appendChild(cansel);\n      console.log(currentOptionBtn.getBoundingClientRect().y, parseFloat(getComputedStyle(usersMenu).height), currentOptionBtn.offsetHeight);\n\n      return wrapper;\n\n      function onBtnClick(e, self) {\n        switch (e.target.dataset.btn) {\n          case 'cansel':\n            e.currentTarget.parentElement.removeChild(e.currentTarget);\n            break;\n        }\n      }\n\n      function onOptionInput(e, self) {\n        setOption(e.currentTarget.dataset.type, optionInput.value, self);\n        currentOptionBtn.querySelector('.setting__value').textContent = optionInput.value;\n      }\n\n      function setOption(type, value, self) {\n        switch (type) {\n          case 'strokeStyle':\n            self.options.strokeStyle = value;\n            break;\n          case 'fillStyle':\n            self.options.fillStyle = value;\n            break;\n          case 'backgroundColor':\n            self.options.backgroundColor = value;\n            self.canvas.style.backgroundColor = value;\n            self.clearCanvas();\n            console.log(self.options.backgroundColor);\n            break;\n        }\n      }\n\n      function setColors(self) {\n        colors.forEach(function (el) {\n          var color = document.createElement('div');\n          color.classList.add('option-menu__color');\n          color.style.backgroundColor = el;\n          color.dataset.color = el;\n          color.addEventListener('click', function (e) {\n            optionInput.value = e.target.dataset.color;\n            currentOptionBtn.querySelector('.setting__value').textContent = optionInput.value;\n            setOption(option, e.target.dataset.color, self);\n          });\n          colorsWrapper.appendChild(color);\n        });\n      }\n    }\n  }, {\n    key: 'initCanvas',\n    value: function initCanvas() {\n      var _this5 = this;\n\n      var canvas = this.canvas;\n      var coords = this.coords;\n      var tool = this.tool;\n      var drawOpts = this.drawOpts;\n      var self = this;\n      var draw = this.draw;\n      var ws = this.ws;\n\n      // Размеры  канвы, за вычетом верхней и боковой панелей\n      canvas.width = window.innerWidth * 4.2 / 5;\n      canvas.height = window.innerHeight * 91 / 100;\n      this.clearCanvas();\n      canvas.style.backgroundColor = this.options.backgroundColor;\n      this.image.style.left = this.canvas.getBoundingClientRect().left + 'px';\n      console.log(this.canvas.getBoundingClientRect().left);\n\n      // Посылаем POST запрос на сервер http://neto-api.herokuapp.com/pic\n      // Тело запроса - формдата, с полями title, image(название, изображение)\n      // В ответе приходит id изображения, записать в imageId конкретной комнаты\n      if (this.isHost) {\n        this.canvasToImage().then(function (res) {\n          return _request.Requests.newImage(imageUrl, res, _this5.host).then(function (res) {\n            _this5.imageId = res.id;\n            _request.Requests.setImageId(requestUrl, _this5.roomId, _this5.imageId).then(console.log).catch(console.log);\n            ws.url = 'wss://neto-api.herokuapp.com/pic/' + _this5.imageId;\n            ws.connection = new WebSocket(ws.url);\n            ws.setListeners();\n          });\n        }).catch(console.log);\n      } else {\n        ws.url = 'wss://neto-api.herokuapp.com/pic/' + this.imageId;\n        ws.connection = new WebSocket(ws.url);\n        ws.setListeners();\n      }\n\n      canvas.addEventListener('mousedown', onMouseDown);\n      canvas.addEventListener('mouseup', onMouseUp);\n\n      function onMouseDown(e) {\n        canvas.addEventListener('mousemove', onMouseMove);\n        drawOpts.isLastPoint = false;\n        drawOpts.isFirstPoint = true;\n\n        var canvasBoundingRect = canvas.getBoundingClientRect();\n        coords.x1 = Math.round(e.pageX - canvasBoundingRect.x);\n        coords.y1 = Math.round(e.pageY - canvasBoundingRect.y);\n\n        draw(tool.current, self);\n        drawOpts.isFirstPoint = false;\n      }\n\n      function onMouseMove(e) {\n        var canvasBoundingRect = canvas.getBoundingClientRect();\n        coords.xCur = Math.round(e.pageX - canvasBoundingRect.x);\n        coords.yCur = Math.round(e.pageY - canvasBoundingRect.y);\n        draw(tool.current, self);\n      }\n\n      function onMouseUp(e) {\n        canvas.removeEventListener('mousemove', onMouseMove);\n        var canvasBoundingRect = canvas.getBoundingClientRect();\n        coords.x2 = Math.round(e.pageX - canvasBoundingRect.x);\n        coords.y2 = Math.round(e.pageY - canvasBoundingRect.y);\n\n        drawOpts.isLastPoint = true;\n        draw(tool.current, self);\n      }\n    }\n  }, {\n    key: 'clearCanvas',\n    value: function clearCanvas() {\n      var ctx = this.ctx;\n      var canvas = this.canvas;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n  }, {\n    key: 'draw',\n    value: function draw(tool, self) {\n      if (self.ableToDraw) {\n        switch (tool) {\n          case 'pen':\n            self.drawPoint();\n            break;\n          case 'line':\n            self.drawLine();\n            break;\n          case 'rectangle':\n            self.drawRect();\n            break;\n          case 'ellipse':\n            self.drawEllipse();\n            break;\n          case 'erase':\n            self.erase();\n            break;\n        }\n      }\n    }\n  }, {\n    key: 'drawBuffered',\n    value: function drawBuffered() {\n      var buffer = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.buffer;\n\n      var ctx = this.ctx;\n      if (buffer.length > 0) {\n        for (var i = 0; i < buffer.length; i++) {\n          switch (buffer[i].type) {\n            case 'point':\n              console.log(this.isQueue, this.lastBufferItem);\n              if (buffer[i].pos === 'first' || i === 0 && (buffer[i].pos === 'last' || buffer[i].pos === 'reg')) {\n                ctx.moveTo(buffer[i].x, buffer[i].y);\n              } else {\n                ctx.lineTo(buffer[i].x, buffer[i].y);\n                ctx.stroke();\n              }\n              this.lastBufferItem = 'point';\n              break;\n            case 'line':\n              console.log('draw line');\n              if (i !== 0 || buffer[i].isPath || buffer[i].pos === 'first') {\n                if (!buffer[i - 1] || buffer[i - 1].type !== 'line') {\n                  ctx.beginPath();\n                  ctx.moveTo(buffer[i].x, buffer[i].y);\n                } else {\n                  ctx.lineTo(buffer[i].x, buffer[i].y);\n                  ctx.stroke();\n                }\n                this.lastBufferItem = 'line';\n                break;\n              }\n            case 'rect':\n              if (buffer[i].isPath || i !== 0) {\n                ctx.beginPath();\n                ctx.rect(buffer[i].x1, buffer[i].y1, buffer[i].x2, buffer[i].y2);\n                ctx.stroke();\n                ctx.fill();\n                ctx.closePath();\n              }\n              break;\n            case 'ellipse':\n              if (buffer[i].isPath || i !== 0) {\n                ctx.beginPath();\n                ctx.ellipse(buffer[i].x, buffer[i].y, buffer[i].dx, buffer[i].dy, 0, 0, 2 * Math.PI);\n                ctx.stroke();\n                ctx.fill();\n                ctx.closePath();\n              }\n          }\n        }\n      }\n    }\n  }, {\n    key: 'drawPoint',\n    value: function drawPoint() {\n      var ctx = this.ctx;\n      var coords = this.coords;\n      var options = this.options;\n\n      if (this.drawOpts.isFirstPoint) {\n        coords.xCur = coords.x1 + options.strokeWidth;\n        coords.yCur = coords.y1 + options.strokeWidth;\n        ctx.beginPath();\n        ctx.strokeStyle = this.options.strokeStyle;\n        ctx.lineWidth = this.options.lineWidth;\n        ctx.lineCap = this.options.lineCap;\n        ctx.lineJoin = this.options.lineJoin;\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        console.log(this.buffer);\n        this.buffer.push({ x: coords.x1, y: coords.y1, type: 'point', pos: 'first' });\n        this.drawBuffered();\n      } else if (!this.drawOpts.isLastPoint) {\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        this.buffer.push({ x: coords.xCur, y: coords.yCur, type: 'point', pos: 'reg' });\n        this.drawBuffered();\n        if (!this.isQueue && this.buffer.length > 20) {\n          this.isQueue = true;\n          this.ws.send();\n        }\n      } else {\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        this.buffer.push({ x: coords.x2, y: coords.y2, type: 'point', pos: 'last' });\n        this.drawBuffered();\n        if (!this.isQueue) {\n          this.isQueue = true;\n          this.ws.send();\n        }\n\n        coords.x1 = coords.xCur;\n        coords.y1 = coords.yCur;\n      }\n    }\n  }, {\n    key: 'drawLine',\n    value: function drawLine() {\n      var ctx = this.ctx;\n      var coords = this.coords;\n      var options = this.options;\n\n      if (this.drawOpts.isFirstPoint) {\n        coords.xCur = coords.x1 + options.strokeWidth;\n        coords.yCur = coords.y1 + options.strokeWidth;\n        ctx.strokeStyle = this.options.strokeStyle;\n        ctx.lineWidth = this.options.lineWidth;\n        ctx.lineCap = this.options.lineCap;\n        ctx.lineJoin = this.options.lineJoin;\n      } else if (!this.drawOpts.isLastPoint) {\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        if (this.pathBuffer.length) {\n          this.pathBuffer.splice(0, this.pathBuffer.length);\n        }\n        this.pathBuffer.push({ x: coords.x1, y: coords.y1, type: 'line', isPath: 'true' });\n        this.pathBuffer.push({ x: coords.xCur, y: coords.yCur, type: 'line', isPath: 'true' });\n        this.drawBuffered(this.pathBuffer);\n      } else {\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        this.buffer.push({ x: coords.x1, y: coords.y1, type: 'line', pos: 'first' });\n        this.buffer.push({ x: coords.x2, y: coords.y2, type: 'line', pos: 'last' });\n        this.drawBuffered();\n        this.ws.send();\n      }\n    }\n  }, {\n    key: 'drawRect',\n    value: function drawRect() {\n      var ctx = this.ctx;\n      var coords = this.coords;\n      var options = this.options;\n      var actions = this.actions;\n\n      if (this.drawOpts.isFirstPoint) {\n        coords.xCur = coords.x1 + options.strokeWidth;\n        coords.yCur = coords.y1 + options.strokeWidth;\n        ctx.fillStyle = this.options.fillStyle;\n        ctx.strokeStyle = this.options.strokeStyle;\n        ctx.lineWidth = this.options.lineWidth;\n      } else if (!this.drawOpts.isLastPoint) {\n        this.clearCanvas();\n        ctx.drawImage(this.image, 0, 0);\n        if (this.pathBuffer.length) {\n          this.pathBuffer.splice(0, this.pathBuffer.length);\n        }\n        this.pathBuffer.push({ x1: coords.x1, y1: coords.y1, x2: coords.xCur - coords.x1, y2: coords.yCur - coords.y1, type: 'rect', isPath: true });\n        this.drawBuffered(this.pathBuffer);\n      } else {\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        this.buffer.push({ type: 'rect', pos: 'first' });\n        this.buffer.push({ x1: coords.x1, y1: coords.y1, x2: coords.xCur - coords.x1, y2: coords.yCur - coords.y1, type: 'rect' });\n        this.drawBuffered();\n        this.ws.send();\n      }\n    }\n  }, {\n    key: 'drawEllipse',\n    value: function drawEllipse() {\n      var ctx = this.ctx;\n      var coords = this.coords;\n      var options = this.options;\n      var actions = this.actions;\n\n      if (this.drawOpts.isFirstPoint) {\n        coords.xCur = coords.x1 + options.strokeWidth;\n        coords.yCur = coords.y1 + options.strokeWidth;\n        ctx.fillStyle = this.options.fillStyle;\n        ctx.strokeStyle = this.options.strokeStyle;\n        ctx.lineWidth = this.options.lineWidth;\n      } else if (!this.drawOpts.isLastPoint) {\n        this.clearCanvas();\n        ctx.drawImage(this.image, 0, 0);\n        if (this.pathBuffer.length) {\n          this.pathBuffer.splice(0, this.pathBuffer.length);\n        }\n        this.pathBuffer.push({ x: coords.x1, y: coords.y1, dx: Math.abs(coords.xCur - coords.x1),\n          dy: Math.abs(coords.yCur - coords.y1), type: 'ellipse', isPath: true });\n        this.drawBuffered(this.pathBuffer);\n      } else {\n        this.clearCanvas();\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        this.buffer.push({ type: 'ellipse', pos: 'first' });\n        this.buffer.push({ x: coords.x1, y: coords.y1, dx: Math.abs(coords.xCur - coords.x1),\n          dy: Math.abs(coords.yCur - coords.y1), type: 'ellipse' });\n        this.drawBuffered();\n        this.ws.send();\n      }\n    }\n  }, {\n    key: 'erase',\n    value: function erase() {\n      var ctx = this.ctx;\n      var coords = this.coords;\n      var options = this.options;\n\n      if (this.drawOpts.isFirstPoint) {\n        coords.xCur = coords.x1 + options.strokeWidth;\n        coords.yCur = coords.y1 + options.strokeWidth;\n        ctx.beginPath();\n        ctx.moveTo(coords.x1, coords.y1);\n      } else if (!this.drawOpts.isLastPoint) {\n        ctx.lineTo(coords.xCur, coords.yCur);\n        ctx.save();\n        ctx.strokeStyle = '#000';\n        ctx.globalCompositeOperation = 'destination-out';\n        console.log(this.options.lineWidth);\n        ctx.lineWidth = options.lineWidth;\n        ctx.stroke();\n        ctx.restore();\n      } else {\n        ctx.lineTo(coords.x2, coords.y2);\n        ctx.save();\n        ctx.strokeStyle = '#000';\n        ctx.globalCompositeOperation = 'destination-out';\n        ctx.lineWidth = options.lineWidth;\n        ctx.stroke();\n        ctx.restore();\n\n        this.ws.send();\n\n        coords.x1 = coords.xCur;\n        coords.y1 = coords.yCur;\n      }\n    }\n  }]);\n\n  return Canvas;\n}();\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 74099ce264045f4fae92","'use strict';\n\nexport class Requests {\n  \n  static getRooms(url) {\n    return new Promise((resolve, reject) => {\n      fetch(url)\n        .then(res => {\n          return res.json();\n        })\n        .then(res => {\n          resolve(res);\n        });\n    });\n  }\n\n  static newRoom(url, host, pass = null) {\n    //Request to adding new room\n    return new Promise((resolve, reject) => {\n      const form = new FormData();\n      form.append('host', host);\n      form.append('password', pass);\n      form.append('roomId', generateRandomRoomId('room'));\n\n      fetch(url, {\n        method: 'POST',\n        body: form\n      })\n        .then(res => {\n          return res.json();\n        })\n        .then(res => {\n          resolve(res);\n        });\n\n      function generateRandomRoomId(base) {\n        const rooms = document.querySelectorAll('.room');\n        let isUnick;\n        let randomEnding;\n\n        do {\n          isUnick = true;\n          randomEnding = Math.round(Math.random() * 10000);\n          rooms.forEach(el => {\n            if (el.dataset.roomId === base + randomEnding)\n              isUnick = false;\n          });\n        } while (!isUnick);\n        \n        return base + randomEnding;\n      }\n    });\n  }\n\n  static connectRoom(url, guest, roomId, pass = null) {\n    //Request to connect the room\n    return new Promise((resolve, reject) => {\n      const form = new FormData();\n      form.append('name', guest);\n      form.append('password', pass);\n      form.append('action', 'connect');\n      form.append('roomId', roomId);\n      console.log(url);\n      fetch(url, {\n        method: 'PUT',\n        body: form\n      })\n        .then(res => {\n          return res.json();\n        })\n        .then(res => {\n          resolve(res);\n        });\n    });\n  }\n\n  static disconnectRoom(url, guest, roomId) {\n    //Request to disconnect the room\n    return new Promise((resolve, reject) => {\n      const form = new FormData();\n      form.append('name', guest);\n      form.append('action', 'disconnect');\n      form.append('roomId', roomId);\n      console.log(url);\n      fetch(url, {\n        method: 'PUT',\n        body: form\n      })\n        .then(res => {\n          return res.json();\n        })\n        .then(res => {\n          resolve(res);\n        });\n    });\n  }\n\n  static deleteRoom(url, roomId) {\n    //Request to delete the room\n    return new Promise((resolve, reject) => {\n      const form = new FormData();\n      form.append('roomId', roomId);\n      console.log(url);\n      fetch(url, {\n        method: 'DELETE',\n        body: form\n      })\n        .then(res => {\n          return res.json();\n        })\n        .then(res => {\n          resolve(res);\n        });\n    });\n  }\n\n  static newImage(url, image, name) {\n    // Посылаем POST запрос на сервер http://neto-api.herokuapp.com/pic\n    // Content-Type: multipart/form-data\n    // Тело запроса - формдата, с полями title, image(название, изображение)\n    // В ответе приходит id изображения, записать в imageId конкретной комнаты\n    // Можно делать данный запрос и передавать в канву в app.js\n    return new Promise((resolve, reject) => {\n      const form = new FormData();\n      form.append('title', name);\n      form.append('image', image);\n      const fetchOpts = {\n        method: 'POST',\n        body: form\n      }\n      fetch(url, fetchOpts)\n        .then(res => {\n          if (res.status === 200)\n            return res.json();\n          else\n            reject(res);\n        })\n        .then(res => {\n          console.log(res);\n          resolve(res);\n        })\n        .catch(reject);\n    });\n  }\n\n  static setImageId(url, roomId, imageId) {\n    return new Promise((resolve, reject) => {\n      const data = new FormData();\n      data.append('roomId', roomId);\n      data.append('imageId', imageId);\n      // const data = JSON.stringify({\n      //   roomId: roomId,\n      //   imageId: imageId\n      // });\n      const fetchOpts = {\n        method: 'PATCH',\n        body: data\n      }\n      fetch(url, fetchOpts)\n        .then(res => res.json())\n        .then(resolve)\n        .catch(reject);\n    });\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/request/request.js","'use strict';\n\nimport './main.scss';\nimport { Room } from './room/room.js';\nimport { Requests } from './request/request.js';\nimport { Popup } from './popup/popup.js';\nimport { Canvas } from './canvas/canvas';\n\n// Адрес один, тк различаются типом запроса GET POST DELETE\nconst requestUrl = 'http://localhost:3000/rooms';\n\nconst root = document.querySelector('#root');\nconst newRoomBtn = document.querySelector(`.new-room--btn`);\nconst roomsList = document.querySelector(`.rooms__list`);\nlet editor = null;\n\nRequests.getRooms(requestUrl)\n  .then(res => {\n    if (res.length) {\n      console.log(res);\n      buildRooms(roomsList, res);\n    }\n    else {\n      document.querySelector('.rooms__title').textContent = 'No Rooms';\n    }\n  })\n  .catch(er => console.log(er));\n\nnewRoomBtn.addEventListener(`click`, onNewRoomBtnClick);\n\n\nfunction buildRooms(wrapper, rooms) {\n  wrapper.textContent = '';\n  rooms.forEach(room => {\n    const roomEl = new Room(room.host, room.roomId, room.users.length - 1, onConnectClick);\n    wrapper.appendChild(roomEl.room);\n  });\n}\n\nfunction onConnectClick(e) {\n  e.preventDefault();\n  const roomId = e.currentTarget.dataset.roomId;\n  if (!e.target.classList.contains('room__connect--btn'))\n    return;\n\n  const popup = new Popup('connectRoom', onPopupSubmitClick, roomId);\n  root.appendChild(popup.popup);\n  document.querySelector('.popup').querySelector('input').focus();\n}\n\nfunction onNewRoomBtnClick(e) {\n  e.preventDefault();\n  const newRoomPopup = new Popup('newRoom', onPopupSubmitClick);\n  root.appendChild(newRoomPopup.popup);\n  document.querySelector('.popup').querySelector('input').focus();\n}\n\nfunction onPopupSubmitClick(e) {\n  e && e.preventDefault();\n  if (!e.target.classList.contains('popup__submit--btn'))\n    return;\n\n  const name = this.querySelector('#nameInput').value;\n  const pass = this.querySelector('#passInput').value;\n  console.log(name, pass);\n\n  if (this.dataset.type === 'newRoom') {\n    Requests.newRoom(requestUrl, name, pass)\n      //Создается объект canvas\n      .then(res => {\n        document.querySelector('.rooms').classList.add('hidden');\n        document.querySelector('.controlls').classList.add('hidden');\n        editor = new Canvas(document.querySelector('.editor'), res.host, res.users, name, true, res.roomId);\n      })\n      .catch(er => console.log(er));\n  }\n  else if (this.dataset.type === 'connectRoom') {\n    const roomId = e.currentTarget.dataset.roomId;\n    console.log(roomId);\n    Requests.connectRoom(requestUrl, name, roomId, pass)\n      //Создается объект canvas\n      .then(res => {\n        document.querySelector('.rooms').classList.add('hidden');\n        document.querySelector('.controlls').classList.add('hidden');\n        editor = new Canvas(document.querySelector('.editor'), res.host, res.users, name, false, roomId, res.imageId, res.background);\n      })\n      .catch(er => console.log(er));\n  }\n\n  this.parentElement.removeChild(this);\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","'use strict';\n\nimport './room.scss'\n\nexport class Room {\n  constructor(hostName, roomId, guestsCount, eventHandler) {\n    this.hostName = hostName;\n    this.guestsCount = guestsCount;\n    this.roomId = roomId;\n    this.room = null;\n    this.updateRoom(this.guestsCount);\n    this.room.addEventListener(`click`, eventHandler);\n  }\n\n  updateRoom(guestsCount) {\n    this.guestsCount = guestsCount;\n\n    this.room = (() => {\n      const room = document.createElement('div');\n      room.classList.add('room');\n      room.dataset.roomId = this.roomId;\n\n      const host = document.createElement('div');\n      host.classList.add('room__host');\n      host.textContent = `Host: ${this.hostName}`;\n\n      const guests = document.createElement('div');\n      guests.classList.add('room__guests');\n      guests.textContent = `Guests: ${this.guestsCount}`;\n\n      const connect = document.createElement('button');\n      connect.classList.add('room__connect--btn');\n      connect.textContent = 'Connect';\n\n      room.appendChild(host);\n      room.appendChild(guests);\n      room.appendChild(connect);\n\n      return room;\n    })();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/room/room.js","'use strict';\n\nimport './popup.scss';\n\nexport class Popup {\n  constructor(type, eventHendler, roomId) {\n    this.type = type;\n    this.popup = null;\n    this.roomId = roomId;\n    this.createPopup();\n    this.popup.addEventListener('click', eventHendler);\n  }\n\n  createPopup() {\n    this.popup = (() => {\n      const popup = document.createElement('div');\n      popup.classList.add('popup');\n      popup.dataset.type = this.type;\n      popup.dataset.roomId = this.roomId;\n\n      const main = document.createElement('div');\n      main.classList.add('popup__main');\n\n      const title = document.createElement('h3');\n      title.classList.add('popup__title');\n      if (this.type === 'newRoom') {\n        title.textContent = 'Creating New Room';\n      }\n      else if (this.type === 'connectRoom') {\n        title.textContent = 'Connecting The Room';\n      }\n\n      const nameWrapper = document.createElement('div');\n      nameWrapper.classList.add('input-wrapper');\n      const nameLabel = document.createElement('label');\n      nameLabel.classList.add('popup__label');\n      nameLabel.setAttribute('for', 'nameInput');\n      nameLabel.textContent = 'Name: ';\n      const nameInput = document.createElement('input');\n      nameInput.classList.add('popup__input');\n      nameInput.id = 'nameInput';\n      nameWrapper.appendChild(nameLabel);\n      nameWrapper.appendChild(nameInput);\n      \n      const passWrapper = document.createElement('div');\n      passWrapper.classList.add('input-wrapper');\n      const passLabel = document.createElement('label');\n      passLabel.classList.add('popup__label');\n      passLabel.setAttribute('for', 'passInput');\n      passLabel.textContent = 'Password: ';\n      const passInput = document.createElement('input');\n      passInput.classList.add('popup__input');\n      passInput.id = 'passInput';\n      passWrapper.appendChild(passLabel);\n      passWrapper.appendChild(passInput);\n\n      const submitButton = document.createElement('button');\n      submitButton.classList.add('popup__submit--btn');\n      submitButton.textContent = 'submit';\n\n      main.appendChild(title);\n      main.appendChild(nameWrapper);\n      main.appendChild(passWrapper);\n      main.appendChild(submitButton);\n      popup.appendChild(main);\n\n      return popup;\n    })();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/popup/popup.js","'use strict';\n\nimport { Requests } from '../request/request.js';\nimport './canvas.scss';\n\nconst requestUrl = 'http://localhost:3000/rooms';\nconst imageUrl = 'https://neto-api.herokuapp.com/pic';\nconst wsUrl = 'wss://neto-api.herokuapp.com/pic';\n\nexport class Canvas {\n  constructor(editorElement, host, users, userName, isHost, roomId, imageId = null, background = '#fff') {\n    this.editor = editorElement;\n    this.host = host;\n    this.users = users;\n    this.userName = userName;\n    this.isHost = isHost;\n    this.ableToDraw = true;\n    this.roomId = roomId;\n    this.imageId = imageId;\n    this.loader = document.querySelector('.canvas-loader');\n    this.buffer = [];\n    this.lastBufferItem = null;\n    this.pathBuffer = [];\n    this.isQueue = false;\n    this.image = this.editor.querySelector('.editor__image');\n    this.image.addEventListener('load', (e) => {\n      this.clearCanvas();\n      console.log('loaded new image');\n      this.ctx.drawImage(this.image, 0, 0);\n      this.drawBuffered();\n      if (this.buffer.length > 1)\n        this.ws.send();\n      else {\n        this.isQueue = false;\n      }\n    });\n    this.canvasBuffer = new Image();\n    this.canvas = this.editor.querySelector('#canvas');\n    this.ctx = canvas.getContext('2d');\n    this.drawOpts = {\n      isFirstPoint: true,\n      isLastPoint: false\n    }\n    this.tool = {\n      current: 'pen'\n    };\n    this.coords = {\n      x1: null,\n      y1: null,\n      x2: null,\n      y2: null,\n      xCur: null,\n      yCur: null\n    };\n    this.options = {\n      lineJoin: 'round',\n      lineCap: 'round',\n      lineWidth: 10,\n      strokeStyle: '#000',\n      fillStyle: '#999',\n      backgroundColor: background\n    }\n    this.ws = {\n      url: null,\n      connection: null,\n      setListeners: () => {\n        this.ws.connection.addEventListener('open', e => console.log('connection opened'));\n        this.ws.connection.addEventListener('message', e => {\n          console.log(`new ws message: ${e.data}`);\n          const data = JSON.parse(e.data);\n          switch (data.event) {\n            case 'pic':\n              this.image.src = data.pic.mask ? data.pic.mask : data.pic.url;\n              this.editor.classList.remove('hidden');\n              this.loader.classList.add('hidden');\n              break;\n            case 'mask':\n              this.image.src = data.url;\n              break;\n          }\n        });\n        this.ws.connection.addEventListener('close', e => console.log('connection closed'));\n        this.ws.connection.addEventListener('error', e => console.log(`some ws error: ${e.data}`));\n        window.addEventListener('beforeunload', e => {\n          this.ws.connection.close();\n          if (this.isHost) {\n            console.log(this);\n            Requests.deleteRoom(requestUrl, this.roomId);\n          }\n        });\n      },\n      send: () => {\n        this.canvasToImage()\n          .then(res => {\n            this.ws.connection.send(res);\n          })\n          .catch(console.log);\n      }\n    };\n\n    this.init();\n    this.editor.querySelector('#pen').classList.add('selected');\n  }\n\n  canvasToImage(self = this, cleared = false) {\n    return new Promise((resolve) => {\n      this.clearCanvas();\n      if (!cleared) {\n        this.ctx.drawImage(this.canvasBuffer, 0, 0);\n        this.drawBuffered();\n      }\n      this.buffer.splice(0, this.buffer.length - 1);\n      self.canvas.toBlob((blob) => {\n        self.canvasBuffer.src = URL.createObjectURL(blob);\n        resolve(blob);\n      });\n    });\n  }\n\n  init() {\n    this.loader.classList.remove('hidden');\n    this.buildUsersPanel();\n    this.buildAsideMenu();\n    this.initCanvas();\n  }\n\n  buildUsersPanel() {\n    const panel = this.editor.querySelector('.users');\n    panel.textContent = '';\n    const usersWrapper = document.createElement('div');\n\n    this.users.forEach(el => {\n      usersWrapper.appendChild(buildUser(el, this));\n    });\n\n    const userPanelControlls = document.createElement('div');\n    userPanelControlls.classList.add('users__control-btns--wrapper');\n    const closeBtn = document.createElement('button');\n    closeBtn.classList.add('users__control-btn');\n    closeBtn.textContent = 'exit';\n    closeBtn.dataset.btn = 'close';\n    const clearBtn = document.createElement('button');\n    clearBtn.classList.add('users__control-btn');\n    clearBtn.textContent = 'clear';\n    clearBtn.dataset.btn = 'clear';\n\n    this.isHost && userPanelControlls.appendChild(clearBtn);\n    userPanelControlls.appendChild(closeBtn);\n\n    panel.appendChild(usersWrapper);\n    panel.appendChild(userPanelControlls);\n\n    userPanelControlls.addEventListener('click', (e, self) => onControllBtnClick(e, this));\n\n    function onControllBtnClick(e, self) {\n      switch (e.target.dataset.btn) {\n        case 'close':\n          console.log('close');\n          document.querySelector('.rooms').classList.remove('hidden');\n          document.querySelector('.controlls').classList.remove('hidden');\n          document.querySelector('.editor').classList.add('hidden');\n          console.log('roomId: ' + self.roomId);\n          this.ws.connection.close();\n          if (!self.isHost) {\n            Requests.disconnectRoom(requestUrl, self.userName, self.roomId);\n          }\n          else {\n            Requests.deleteRoom(requestUrl, self.roomId);\n          }\n          self = null;\n          break;\n        case 'clear':\n          if (self.isHost) {\n            console.log('clear');\n            self.canvasToImage(self, true)\n              .then(res => self.ws.connection.send(res))\n              .catch(console.log);\n          }\n          break;\n      }\n    }\n\n    function buildUser(user, self) {\n      const wrapper = document.createElement('div');\n      wrapper.classList.add('user');\n\n      const title = document.createElement('h3');\n      title.classList.add('user__title');\n      title.textContent = user.isHost ? 'Host: ' : 'Guest: '\n\n      const userName = document.createElement('div');\n      userName.classList.add('user__name');\n      userName.textContent = user.name;\n\n      const controlls = document.createElement('div');\n      controlls.classList.add('user__controls');\n      const togglePermission = document.createElement('button');\n      togglePermission.classList.add('user__btn');\n      togglePermission.textContent = 'D';\n      const removeGuest = document.createElement('button');\n      removeGuest.classList.add('user__btn');\n      removeGuest.textContent = 'X';\n      controlls.appendChild(togglePermission);\n      controlls.appendChild(removeGuest);\n\n      const permissions = document.createElement('div');\n      permissions.classList.add('user__permissions');\n      const permissionTitle = document.createElement('div');\n      permissionTitle.classList.add('user__permission-title');\n      permissionTitle.textContent = 'Drawing';\n      const permissionStatus = document.createElement('div');\n      permissionStatus.classList.add('user__permission-status');\n      permissions.appendChild(permissionTitle);\n      permissions.appendChild(permissionStatus);\n\n      wrapper.appendChild(title);\n      wrapper.appendChild(userName);\n      wrapper.appendChild(self.isHost ? controlls : permissions);\n      if (user.isHost) {\n        controlls.style.opacity = 0;\n        permissions.style.opacity = 0;\n      }\n\n      return wrapper;\n    }\n  }\n\n  buildAsideMenu() {\n    const aside = this.editor.querySelector('.editor__menu');\n    const tools = [\n      'pen',        'line',\n      'rectangle',  'ellipse',\n      '',           '',\n      'erase'\n    ];\n\n    const settings = [\n      'lineWidth',\n      'fillStyle',  \n      'strokeStyle',\n      'backgroundColor'\n    ];\n\n    const toolsWrapper = document.createElement('div');\n    toolsWrapper.classList.add('users__tools-wrapper');\n    const settingsWrapper = document.createElement('div');\n    settingsWrapper.classList.add('users__settings-wrapper');\n\n    aside.textContent = '';\n    tools.forEach(el => {\n      addAsideElement(toolsWrapper, el, this);\n    });\n    settings.forEach(el => {\n      addSettingElement(settingsWrapper, el, this);\n    });\n\n    aside.appendChild(toolsWrapper);\n    aside.appendChild(settingsWrapper);\n\n    function addAsideElement(wrapper, tool, self) {\n      const element = document.createElement('div');\n      if (tool === '') {\n        element.classList.add('hidden-tool');\n      }\n      else {\n        element.classList.add('tool');\n        element.id = tool;\n        element.textContent = tool;\n        element.addEventListener('click', (e) => {\n          onToolClick(e, self);\n        });\n      }\n      wrapper.appendChild(element);\n    }\n\n    function addSettingElement(wrapper, element, self) {\n      const settingElement = document.createElement('div');\n\n      settingElement.classList.add('setting');\n      settingElement.id = element;\n      settingElement.addEventListener('click', (e) => {\n        onSettingClick(e, self);\n      });\n      const title = document.createElement('div');\n      const name = document.createElement('div');\n      name.classList.add('setting__name')\n      const value = document.createElement('div');\n      value.classList.add('setting__value');\n      name.textContent = element + ': ';\n      switch (element) {\n        case 'lineWidth':\n          const widthInput = document.createElement('input');\n          widthInput.classList.add('setting__input');\n          widthInput.value = self.options.lineWidth;\n          widthInput.addEventListener('input', (e) => {\n            self.options.lineWidth = e.currentTarget.value;\n          });\n          value.appendChild(widthInput);\n          break;\n        case 'strokeStyle':\n          value.textContent = self.options.strokeStyle;\n          break;\n        case 'fillStyle':\n          value.textContent = self.options.fillStyle;\n          break;\n        case 'backgroundColor':\n          value.textContent = self.options.backgroundColor;\n          break;\n        default:\n      }\n      title.appendChild(name);\n      title.appendChild(value);\n      settingElement.appendChild(title);\n      wrapper.appendChild(settingElement);\n    }\n\n    function onToolClick(e, self) {\n      self.editor.querySelector('.selected').classList.remove('selected');\n      self.tool.current = e.currentTarget.id;\n      e.currentTarget.classList.add('selected');\n    }\n\n    function onSettingClick(e, self) {\n      switch (e.currentTarget.id) {\n        case 'lineWidth':\n          const lineWidthInput = aside.querySelector('#lineWidth').querySelector('.setting__input');\n          lineWidthInput.focus();\n          break;\n        case 'strokeStyle':\n        case 'fillStyle':\n        case 'backgroundColor':\n          if (self.editor.querySelector('.option-menu'))\n            aside.removeChild(self.editor.querySelector('.option-menu'));\n          aside.appendChild(self.showOptionMenu(e.currentTarget.id));\n          break;\n        default:\n          if (self.editor.querySelector('.option-menu'))\n            aside.removeChild(self.editor.querySelector('.option-menu'));\n      }\n    }\n  }\n\n  showOptionMenu(option) {\n    const self = this;\n    const currentOptionBtn = document.getElementById(option);\n    const usersMenu = document.querySelector('.users');\n\n    const colors = [\n      'white', 'black', 'red', 'orange', \n      'yellow', 'green', 'blue', 'purple'\n    ]\n    const wrapper = document.createElement('div');\n    wrapper.classList.add('option-menu');\n    const title = document.createElement('h3');\n    const colorsWrapper = document.createElement('div');\n    colorsWrapper.classList.add('option-menu__colors');\n    setColors(this);\n    const optionInput = document.createElement('input');\n    optionInput.classList.add('option-menu__input');\n    optionInput.value = this.options[option];\n    const cansel = document.createElement('button');\n    cansel.textContent = 'Cansel';\n    cansel.dataset.btn = 'cansel';\n\n    switch (option) {\n      case 'strokeStyle':\n        title.textContent = 'Stroke Color:';\n        wrapper.dataset.type = 'strokeStyle';\n        break;\n      case 'fillStyle':\n        title.textContent = 'Fill Color:';\n        wrapper.dataset.type = 'fillStyle';\n        break;\n      case 'backgroundColor':\n        title.textContent = 'Background Color:';\n        wrapper.dataset.type = 'backgroundColor';\n        break;\n    }\n\n    wrapper.addEventListener('click', (e) => onBtnClick(e, self));\n    wrapper.addEventListener('input', (e) => onOptionInput(e, self));\n\n    wrapper.appendChild(title);\n    wrapper.appendChild(colorsWrapper);\n    wrapper.appendChild(optionInput);\n    wrapper.appendChild(cansel);\n    console.log(currentOptionBtn.getBoundingClientRect().y, parseFloat(getComputedStyle(usersMenu).height), currentOptionBtn.offsetHeight);\n\n    return wrapper;\n\n    function onBtnClick(e, self) {\n      switch (e.target.dataset.btn) {\n        case 'cansel':\n          e.currentTarget.parentElement.removeChild(e.currentTarget);\n          break;\n      }\n    }\n\n    function onOptionInput(e, self) {\n      setOption(e.currentTarget.dataset.type, optionInput.value, self);\n      currentOptionBtn.querySelector('.setting__value').textContent = optionInput.value;\n    }\n\n    function setOption(type, value, self) {\n      switch (type) {\n        case 'strokeStyle':\n          self.options.strokeStyle = value;\n          break;\n        case 'fillStyle':\n          self.options.fillStyle = value;\n          break;\n        case 'backgroundColor':\n          self.options.backgroundColor = value;\n          self.canvas.style.backgroundColor = value;\n          self.clearCanvas();\n          console.log(self.options.backgroundColor);\n          break;\n      }\n    }\n\n    function setColors(self) {\n      colors.forEach(el => {\n        const color = document.createElement('div');\n        color.classList.add('option-menu__color');\n        color.style.backgroundColor = el;\n        color.dataset.color = el;\n        color.addEventListener('click', (e) => {\n          optionInput.value = e.target.dataset.color;\n          currentOptionBtn.querySelector('.setting__value').textContent = optionInput.value;\n          setOption(option, e.target.dataset.color, self);\n        });\n        colorsWrapper.appendChild(color);\n      });\n    }\n  }\n\n  initCanvas() {\n    const canvas = this.canvas;\n    const coords = this.coords;\n    const tool = this.tool;\n    const drawOpts = this.drawOpts;\n    const self = this;\n    const draw = this.draw;\n    const ws = this.ws;\n\n    // Размеры  канвы, за вычетом верхней и боковой панелей\n    canvas.width = window.innerWidth * 4.2 / 5;\n    canvas.height = window.innerHeight * 91 / 100;\n    this.clearCanvas();\n    canvas.style.backgroundColor = this.options.backgroundColor;\n    this.image.style.left = this.canvas.getBoundingClientRect().left + 'px';\n    console.log(this.canvas.getBoundingClientRect().left);\n\n    // Посылаем POST запрос на сервер http://neto-api.herokuapp.com/pic\n    // Тело запроса - формдата, с полями title, image(название, изображение)\n    // В ответе приходит id изображения, записать в imageId конкретной комнаты\n    if (this.isHost) {\n      this.canvasToImage()\n        .then(res => Requests.newImage(imageUrl, res, this.host)\n        .then(res => {\n          this.imageId = res.id;\n          Requests.setImageId(requestUrl, this.roomId, this.imageId)\n            .then(console.log)\n            .catch(console.log);\n          ws.url = `wss://neto-api.herokuapp.com/pic/${this.imageId}`;\n          ws.connection = new WebSocket(ws.url);\n          ws.setListeners();\n        }))\n        .catch(console.log);\n    }\n    else {\n      ws.url = `wss://neto-api.herokuapp.com/pic/${this.imageId}`;\n      ws.connection = new WebSocket(ws.url);\n      ws.setListeners();\n    }\n    \n    canvas.addEventListener('mousedown', onMouseDown);\n    canvas.addEventListener('mouseup', onMouseUp);\n\n    function onMouseDown(e) {\n      canvas.addEventListener('mousemove', onMouseMove);\n      drawOpts.isLastPoint = false;\n      drawOpts.isFirstPoint = true;\n\n      const canvasBoundingRect = canvas.getBoundingClientRect();\n      coords.x1 = Math.round(e.pageX - canvasBoundingRect.x);\n      coords.y1 = Math.round(e.pageY - canvasBoundingRect.y);\n\n      draw(tool.current, self);\n      drawOpts.isFirstPoint = false;\n    }\n\n    function onMouseMove(e) {\n      const canvasBoundingRect = canvas.getBoundingClientRect();\n      coords.xCur = Math.round(e.pageX - canvasBoundingRect.x);\n      coords.yCur = Math.round(e.pageY - canvasBoundingRect.y);\n      draw(tool.current, self);\n    }\n\n    function onMouseUp(e) {\n      canvas.removeEventListener('mousemove', onMouseMove);\n      const canvasBoundingRect = canvas.getBoundingClientRect();\n      coords.x2 = Math.round(e.pageX - canvasBoundingRect.x);\n      coords.y2 = Math.round(e.pageY - canvasBoundingRect.y);\n\n      drawOpts.isLastPoint = true;\n      draw(tool.current, self);\n    }\n  }\n\n  clearCanvas() {\n    const ctx = this.ctx;\n    const canvas = this.canvas;\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n  }\n\n  draw(tool, self) {\n    if (self.ableToDraw) {\n      switch(tool) {\n        case 'pen':\n          self.drawPoint();\n          break;\n        case 'line':\n          self.drawLine();\n          break;\n        case 'rectangle':\n          self.drawRect();\n          break;\n        case 'ellipse':\n          self.drawEllipse();\n          break;\n        case 'erase':\n          self.erase();\n          break;\n      }\n    }\n  }\n\n  drawBuffered(buffer = this.buffer) {\n    const ctx = this.ctx;\n    if (buffer.length > 0) {\n      for (let i = 0; i < buffer.length; i++) {\n        switch (buffer[i].type) {\n          case 'point':\n            console.log(this.isQueue, this.lastBufferItem);\n            if (buffer[i].pos === 'first' || i === 0 && (buffer[i].pos === 'last' || buffer[i].pos === 'reg')) {\n              ctx.moveTo(buffer[i].x, buffer[i].y);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \n            }\n            else {\n              ctx.lineTo(buffer[i].x, buffer[i].y);\n              ctx.stroke();\n            } \n            this.lastBufferItem = 'point';\n            break;\n          case 'line':\n            console.log('draw line');\n            if (i !== 0 || buffer[i].isPath || buffer[i].pos === 'first') {\n              if (!buffer[i - 1] || buffer[i - 1].type !== 'line') {\n                ctx.beginPath();\n                ctx.moveTo(buffer[i].x, buffer[i].y);\n              }\n              else {\n                ctx.lineTo(buffer[i].x, buffer[i].y);\n                ctx.stroke();\n              }\n              this.lastBufferItem = 'line';\n              break;\n            }\n          case 'rect':\n            if (buffer[i].isPath || i !== 0) {\n              ctx.beginPath();\n              ctx.rect(buffer[i].x1, buffer[i].y1, buffer[i].x2, buffer[i].y2);\n              ctx.stroke();\n              ctx.fill();\n              ctx.closePath();\n            }\n            break;\n          case 'ellipse':\n            if (buffer[i].isPath || i !== 0) {\n              ctx.beginPath();\n              ctx.ellipse(buffer[i].x, buffer[i].y, buffer[i].dx, buffer[i].dy, 0, 0, 2 * Math.PI);\n              ctx.stroke();\n              ctx.fill();\n              ctx.closePath();\n            }\n        }\n      }\n    }\n  }\n\n  drawPoint() {\n    const ctx = this.ctx;\n    const coords = this.coords;\n    const options = this.options;\n\n    if (this.drawOpts.isFirstPoint) {\n      coords.xCur = coords.x1 + options.strokeWidth;\n      coords.yCur = coords.y1 + options.strokeWidth;\n      ctx.beginPath();\n      ctx.strokeStyle = this.options.strokeStyle;\n      ctx.lineWidth = this.options.lineWidth;\n      ctx.lineCap = this.options.lineCap;\n      ctx.lineJoin = this.options.lineJoin;\n      this.clearCanvas();\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      console.log(this.buffer);\n      this.buffer.push({x: coords.x1, y: coords.y1, type: 'point', pos: 'first'});\n      this.drawBuffered();\n    }\n    else if (!this.drawOpts.isLastPoint) {\n      this.clearCanvas()\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      this.buffer.push({x: coords.xCur, y: coords.yCur, type: 'point', pos: 'reg'});\n      this.drawBuffered();\n      if (!this.isQueue && this.buffer.length > 20) {\n        this.isQueue = true;\n        this.ws.send();\n      }\n    }\n    else {\n      this.clearCanvas()\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      this.buffer.push({x: coords.x2, y: coords.y2, type: 'point', pos: 'last'});\n      this.drawBuffered();\n      if (!this.isQueue) {\n        this.isQueue = true;\n        this.ws.send();\n      }\n\n      coords.x1 = coords.xCur;\n      coords.y1 = coords.yCur;\n    }\n  }\n\n  drawLine() {\n    const ctx = this.ctx;\n    const coords = this.coords;\n    const options = this.options;\n\n    if (this.drawOpts.isFirstPoint) {\n      coords.xCur = coords.x1 + options.strokeWidth;\n      coords.yCur = coords.y1 + options.strokeWidth;\n      ctx.strokeStyle = this.options.strokeStyle;\n      ctx.lineWidth = this.options.lineWidth;\n      ctx.lineCap = this.options.lineCap;\n      ctx.lineJoin = this.options.lineJoin;\n    }\n    else if (!this.drawOpts.isLastPoint) {\n      this.clearCanvas();\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      if (this.pathBuffer.length) {\n        this.pathBuffer.splice(0, this.pathBuffer.length);\n      }\n      this.pathBuffer.push({x: coords.x1, y: coords.y1, type: 'line', isPath: 'true'});\n      this.pathBuffer.push({x: coords.xCur, y: coords.yCur, type: 'line', isPath: 'true'});\n      this.drawBuffered(this.pathBuffer);\n    }\n    else {\n      this.clearCanvas();\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      this.buffer.push({x: coords.x1, y: coords.y1, type: 'line', pos: 'first'});\n      this.buffer.push({x: coords.x2, y: coords.y2, type: 'line', pos: 'last'});\n      this.drawBuffered();\n      this.ws.send();\n    }\n  }\n\n  drawRect() {\n    const ctx = this.ctx;\n    const coords = this.coords;\n    const options = this.options;\n    const actions = this.actions;\n\n    if (this.drawOpts.isFirstPoint) {\n      coords.xCur = coords.x1 + options.strokeWidth;\n      coords.yCur = coords.y1 + options.strokeWidth;\n      ctx.fillStyle = this.options.fillStyle;\n      ctx.strokeStyle = this.options.strokeStyle;\n      ctx.lineWidth = this.options.lineWidth;\n    }\n    else if (!this.drawOpts.isLastPoint) {\n      this.clearCanvas();\n      ctx.drawImage(this.image, 0, 0);\n      if (this.pathBuffer.length) {\n        this.pathBuffer.splice(0, this.pathBuffer.length);\n      }\n      this.pathBuffer.push({x1: coords.x1, y1: coords.y1, x2: coords.xCur - coords.x1, y2: coords.yCur - coords.y1, type: 'rect', isPath: true});\n      this.drawBuffered(this.pathBuffer);\n    }\n    else {\n      this.clearCanvas();\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      this.buffer.push({type: 'rect', pos: 'first'});\n      this.buffer.push({x1: coords.x1, y1: coords.y1, x2: coords.xCur - coords.x1, y2: coords.yCur - coords.y1, type: 'rect'});\n      this.drawBuffered();\n      this.ws.send();\n    }\n  }\n\n  drawEllipse() {\n    const ctx = this.ctx;\n    const coords = this.coords;\n    const options = this.options;\n    const actions = this.actions;\n\n    if (this.drawOpts.isFirstPoint) {\n      coords.xCur = coords.x1 + options.strokeWidth;\n      coords.yCur = coords.y1 + options.strokeWidth;\n      ctx.fillStyle = this.options.fillStyle;\n      ctx.strokeStyle = this.options.strokeStyle;\n      ctx.lineWidth = this.options.lineWidth;\n    }\n    else if (!this.drawOpts.isLastPoint) {\n      this.clearCanvas();\n      ctx.drawImage(this.image, 0, 0);\n      if (this.pathBuffer.length) {\n        this.pathBuffer.splice(0, this.pathBuffer.length);\n      }\n      this.pathBuffer.push({x: coords.x1, y: coords.y1, dx: Math.abs(coords.xCur - coords.x1), \n                            dy: Math.abs(coords.yCur - coords.y1), type: 'ellipse', isPath: true});\n      this.drawBuffered(this.pathBuffer);\n    }\n    else {\n      this.clearCanvas();\n      this.ctx.drawImage(this.canvasBuffer, 0, 0);\n      this.buffer.push({type: 'ellipse', pos: 'first'});\n      this.buffer.push({x: coords.x1, y: coords.y1, dx: Math.abs(coords.xCur - coords.x1), \n                        dy: Math.abs(coords.yCur - coords.y1), type: 'ellipse'});\n      this.drawBuffered();\n      this.ws.send();\n    }\n  }\n\n  erase() {\n    const ctx = this.ctx;\n    const coords = this.coords;\n    const options = this.options;\n\n    if (this.drawOpts.isFirstPoint) {\n      coords.xCur = coords.x1 + options.strokeWidth;\n      coords.yCur = coords.y1 + options.strokeWidth;\n      ctx.beginPath();\n      ctx.moveTo(coords.x1, coords.y1);\n    }\n    else if (!this.drawOpts.isLastPoint) {\n      ctx.lineTo(coords.xCur, coords.yCur);\n      ctx.save();\n      ctx.strokeStyle = '#000';\n      ctx.globalCompositeOperation = 'destination-out';\n      console.log(this.options.lineWidth);\n      ctx.lineWidth = options.lineWidth;\n      ctx.stroke();\n      ctx.restore();\n    }\n    else {\n      ctx.lineTo(coords.x2, coords.y2);\n      ctx.save();\n      ctx.strokeStyle = '#000';\n      ctx.globalCompositeOperation = 'destination-out';\n      ctx.lineWidth = options.lineWidth;\n      ctx.stroke();\n      ctx.restore();\n\n      this.ws.send();\n\n      coords.x1 = coords.xCur;\n      coords.y1 = coords.yCur;\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/canvas/canvas.js"],"sourceRoot":""}